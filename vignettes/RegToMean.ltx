%\VignetteIndexEntry{RegToMean}
%\VignetteEngine{R.rsp::tex}


\documentclass{scrartcl}\usepackage[]{graphicx}\usepackage[]{color}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.882, 0.878, 0.898}
\makeatletter
\@ifundefined{AddToHook}{}{\AddToHook{package/xcolor/after}{\definecolor{fgcolor}{rgb}{0.882, 0.878, 0.898}}}
\makeatother
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.82,0.78,0.62}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.82,0.78,0.62}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.404,0.408,0.42}{#1}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0.882,0.878,0.898}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.882,0.878,0.898}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.384,0.675,0.808}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.902,0.675,0.196}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.812,0.522,0.388}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.733,0.388,0.812}{#1}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\makeatletter
\@ifundefined{AddToHook}{}{\AddToHook{package/xcolor/after}{
\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
}}
\makeatother
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
% \usepackage{preamb}
\usepackage{texab}
% \pagestyle{scrheadings}
% \ifoot{Meichtry, \today}

% \VignetteIndexEntry{Regression to the mean}
% \VignetteEngine{knitr::knitr}




 


\title{Shrinkage and regression to the mean}
\author{Andr√© Meichtry}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}


\maketitle
%\tableofcontents
\scriptsize

\dictum[Stephen Senn]{Shrinkage of results can be seen to be a necessary fact of life.}

\normalsize




\section{Shrinkage is a fact of life}
\label{sec:example}

Assume true diastolic blood pressure, $\tau$, at baseline is measured
with error $\epsilon$ so that
\begin{equation}
  \label{eq:4}
  X=\tau+\epsilon
\end{equation}
is the \emph{observed} blood pressure. Let the \emph{true} mean
difference between patients be $\Delta$ and the \emph{observed} mean
difference $D$, then the expectation of $D$ is
\begin{equation}
  \label{eq:6}
  \Erw(D\mid\Delta=\delta)=\delta,
\end{equation}
that is, we have ``classical''
  \emph{unbiasedness}, since $\beta_{D\mid
    \Delta}=\frac{\Cov(\Delta,D)}{\sigma^2_\Delta}=1$.
  
  However, the
contrary is not true. We have for the expectation of $\Delta$, given
an observed difference $d$,
\begin{equation}
  \label{eq:7}
  \abs{\Erw(\Delta\mid D=d)}< \abs{d},
\end{equation}
since $\beta_{\Delta\mid D}=\frac{\Cov(\Delta,D)}{\sigma^2_D}< 1$, and 
we have \emph{regression to the mean}\footnote{\paragraph{In a Bayesian
    approach,} shrinking is \emph{natural} and we have \emph{inverse
    unbiasedness}. Most bayesians are rather unconcerned about
  unbiasedness (at least in the formal sampling-theory sense above) of
  their estimates. For example, Gelman et al (1995) write: ``From a
  Bayesian perspective, the principle of unbiasedness is reasonable in
  the limit of large samples, but otherwise it is potentially
  misleading. Unbiasedness as conventionally understood is not a
  necessary property of good inferences''. Assume without loss of
  generality $\Erw(\Delta)=0$ and $\wh{\Delta}$ an unbiased estimate
  of a given effect $\Delta$ and $\wh{\Delta}_{shrunk}$ a shrunk
  estimate. Although $\wh{\Delta}_{shrunk}$ is not unbiased in the
  classic forward sense, $\Erw(\wh{\Delta}_{shrunk} \mid
  \Delta=\delta)\neq \delta$ it is unbiased in the Bayesian backward
  sense: $\Erw(\Delta\mid \wh{\Delta}_{shrunk}=\wh{\delta}_{shrunk})=
  \wh{\delta}_{shrunk}$.}.






\begin{figure}
  \centering
 
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.165, 0.169, 0.184}\color{fgcolor}

{\centering \includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-2-1} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-2-2} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-2-3} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-2-4} 

}


\end{knitrout}
 
  
  \caption{Shrinkage as a fact of life}
\end{figure}




\paragraph{Reliability as upper bound}
\label{sec:reliability-as-upper}


The maximal possible correlation between $\Delta$ and $D$ is
$\sqrt{rel_D}$.


% <<echo=TRUE>>=
% cor(Delta,D)
% sqrt(reliab)
%@

\section{Placebo as a statistical phenomenon}


Placebo effects can often be interpreted as a purely
      statistical -- not a psychological -- phenomenon.


\paragraph{Assuming no true change.}
\label{sec:assuming-no-true}


We simulate correlated pre-post diastolic blood pressure data  assuming \emph{no change}
from baseline to follow-up: simulations from parameters: $\rho_{BL,FU}=0.76,
      \mu_{BL}=\mu_{FU}=90, \sigma_{BL}=\sigma_{FU}=8$. Then let us
      look at the \emph{subgroup} of ``hypertensive at baseline''
      only. We have regression to the mean, since
 $\beta_{FU \mid BL}=\frac{\sigma_{FU,BL}}{\sigma^2_{BL}}=r\leq1$.
      
      




  \begin{figure}
    \centering

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.165, 0.169, 0.184}\color{fgcolor}

{\centering \includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-4-1} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-4-2} 

}


\end{knitrout}
      \caption{Simulation of diastolic blood pressure data. Simulations from parameters: $\rho_{BL,FU}=0.76,
      \mu_{BL}=\mu_{FU}=90, \sigma_{BL}=\sigma_{FU}=8$. Left panel:
      Baseline versus Follow-up for diastolic blood pressure: no
      change in the mean. Right panel: Baseline versus Follow-up for
      ``hypertensive at baseline'' only. We observe an apparent change
      due to regression to the mean (Solid line: Regression of
      follow-up on baseline-measure (that is, by fixing
      baseline)). Dashed lines: mean values and equality
      lines.}
    
  \end{figure}

\normalsize  

\newpage
\paragraph{Extreme case: $\rho$=0}~

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.165, 0.169, 0.184}\color{fgcolor}

{\centering \includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-5-1} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-5-2} 

}


\end{knitrout}

\normalsize



\paragraph{Including a true change of -10 and $\rho$=.8}~

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.165, 0.169, 0.184}\color{fgcolor}

{\centering \includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-6-1} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-6-2} 

}


\end{knitrout}



\newpage
\paragraph{Including a true change of -10 and $\rho$=.4}~

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.165, 0.169, 0.184}\color{fgcolor}

{\centering \includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-7-1} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-7-2} 

}


\end{knitrout}


\paragraph{$\rho$=1 (Perfect reliability)}~
\label{sec:two-extreme-cases}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.165, 0.169, 0.184}\color{fgcolor}

{\centering \includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-8-1} 
\includegraphics[width=0.49\linewidth]{figures/unnamed-chunk-8-2} 

}


\end{knitrout}



\newpage
\appendix

\normalsize

\section{Maths}
\label{sec:important-relations}

The conditional expected value of $Y$, given that $X$ is $t$ standard
deviations above its mean (and that includes the case where it is below its mean,
when $t < 0$), is $\rho t$ standard deviations above the mean of $Y$ .

Since $\abs{\rho}\leq 1$, $Y$
is no farther from the mean than $X$ is, as measured in the number of standard
deviations. Hence, if $0 \leq \rho < 1$, then $(X, Y)$ shows regression toward the mean.

\begin{equation}
  \label{eq:1}
  \boxed{\frac{\Erw(Y\mid X)-\Erw(Y)}{\sigma_Y}=\rho\frac{X-\Erw(X)}{\sigma_X}},
\end{equation}

that is, $z_{Y\mid X}=\rho z_x$, leading to $z_{Y\mid X}-z_X=(\rho-1)z_x$. The amount of RTM
is 
\begin{equation}
  \label{eq:2}
  \boxed{\abs{z_{Y\mid X}-z_x}=(1-\rho)z_x}.
\end{equation}


The estimated fraction of RTM is given by $1-\rho$, the fraction of
variance that is due to within-subject variability. This quantity represents
\emph{unreliability}.



% \paragraph{General definition.} Let $X$, $Y$ be random variables with identical marginal
% distributions with mean $\mu$. In this formalization, the bivariate distribution of
% $X$ and $Y$ is said to exhibit reversion toward the mean if, for every number $c$,
% we have
% \begin{align}
%   \Erw(Y\mid X>c)&< \Erw(X\mid X>c)\\
%   \Erw(Y\mid X<c)&> \Erw(X\mid X<c)\\\nonumber
% \end{align}

\end{document}

